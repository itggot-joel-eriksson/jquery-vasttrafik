/*! jquery-vasttrafik v1.0 | (c) 2015 Joel Eriksson | https://github.com/itggot-joel-eriksson/jquery-vasttrafik/blob/master/LICENSE */
!function(t){t.fn.vasttrafik=function(s,e){function o(t,s){return isNaN(t)||isNaN(s)?NaN:Math.abs(Math.floor(t-s))}var a,n=this.selector,r={},i={url:"https://api.fam-ericsson.se/vasttrafik/?id=",stopId:"9021014001960000",method:"GET",crossDomain:!0,cache:!1,async:!0,departureNow:"now",departureNone:"No departures",lineColors:{55:{bgColor:"#EAF5CC",fgColor:"#3AB73D"}}},c=t.extend({},i,s);return t.ajax({url:c.url+c.stopId,method:c.method,crossDomain:c.crossDomain,cache:c.cache,async:c.async,dataType:"json",statusCode:{200:function(){r.statusCode=200,r.statusDescription="OK"},401:function(){r.statusCode=401,r.statusDescription="Unauthorized"},403:function(){r.statusCode=403,r.statusDescription="Forbidden"},404:function(){r.statusCode=404,r.statusDescription="Not Found"},500:function(){r.statusCode=500,r.statusDescription="Internal Server Error"},501:function(){r.statusCode=501,r.statusDescription="Not Implemented"},502:function(){r.statusCode=502,r.statusDescription="Bad Gateway"},503:function(){r.statusCode=503,r.statusDescription="Service Unavailable"}},success:function(s){if(r.success=!0,a=s,null!==a.trafik){var e=a.serverDateTime.unixTimestamp;t(n).html(""),t.each(a.trafik,function(s,a){t.each(a.avgang,function(s,r){var i=o(r.unixTimestamp[0],e)/60,d=o(r.unixTimestamp[1],e)/60;isNaN(d)&&(d="-"),0>=i&&(i=c.departureNow),0>=d&&(d=departureNow),typeof c.lineColors[a.linje]==typeof{}&&(a.bgFarg=c.lineColors[a.linje].bgColor,a.fgFarg=c.lineColors[a.linje].fgColor),t(n).append("<tr><td class='linje' style='background-color: "+a.bgFarg+"; color: "+a.fgFarg+";'>"+a.linje+"</td><td> "+r.resmal+" </td><td class='lage'>"+r.lage[0]+"</td><td class='tid'>"+i+"</td><td class='tid'>"+d+"</td>")})})}else t(n).html("<tr><td class='linje' style='background-color: #F44336; color: #FFFFFF'>-</td><td>"+c.departureNone+"</td><td class='lage'>-</td><td class='tid'>60+</td><td class='tid'>-</td>")},error:function(t){r.success=!1}}),r.target=n,"function"==typeof e?e(r):r}}(jQuery);
